%function which prepares snub cube measurements and rotate it by a qubit unitary U
%Input:  a qubit unitary U
%Output: Set of measurements stored as M(:,:,i,x)
%Author: Marco TÃºlio Quintino, https://github.com/mtcq

function M=snubMeasurements(U)

id=eye(2);
X=[0 1;1 0];
Y=[0 -sqrt(-1);sqrt(-1) 0];
Z=[1 0;0 -1];

t=(1+4*cosh(1/3*acosh(2+3/8)))/3;
nn=norm([1 1/t t]);
v1=[1 1/t -t]/nn;
v2=[1 -1/t t]/nn;
v3=[-1 1/t t]/nn;
v4=[-1 -1/t -t]/nn;
v5=[1/t t -1]/nn;
v6=[1/t -t 1]/nn;
v7=[-1/t t  1]/nn;
v8=[-1/t -t  -1]/nn;
v9=[t 1 1/t]/nn;
v10=[t 1 -1/t]/nn;
v11=[t -1 1/t]/nn;
v12=[t -1 -1/t]/nn;
v13=[1/t 1 t]/nn;
v14=[1/t -1 -t]/nn;
v15=[-1/t 1 -t]/nn;
v16=[-1/t -1 t]/nn;
v17=[t 1/t 1]/nn;
v18=[t -1/t -1]/nn;
v19=[-t 1/t -1]/nn;
v20=[-t -1/t 1]/nn;
v21=[1 t 1/t]/nn;
v22=[1 -t -1/t]/nn;
v23=[-1 t -1/t]/nn;
v24=[-1 -t 1/t]/nn;

M(:,:,1,1)=U*(id+v1(1)*X+v1(2)*Y+v1(3)*Z)/2*U'; M(:,:,2,1)=id-M(:,:,1,1);
M(:,:,1,2)=U*(id+v2(1)*X+v2(2)*Y+v2(3)*Z)/2*U'; M(:,:,2,2)=id-M(:,:,1,2);
M(:,:,1,3)=U*(id+v3(1)*X+v3(2)*Y+v3(3)*Z)/2*U'; M(:,:,2,3)=id-M(:,:,1,3);
M(:,:,1,4)=U*(id+v4(1)*X+v4(2)*Y+v4(3)*Z)/2*U'; M(:,:,2,4)=id-M(:,:,1,4);
M(:,:,1,5)=U*(id+v5(1)*X+v5(2)*Y+v5(3)*Z)/2*U'; M(:,:,2,5)=id-M(:,:,1,5);
M(:,:,1,6)=U*(id+v6(1)*X+v6(2)*Y+v6(3)*Z)/2*U'; M(:,:,2,6)=id-M(:,:,1,6);
M(:,:,1,7)=U*(id+v7(1)*X+v7(2)*Y+v7(3)*Z)/2*U'; M(:,:,2,7)=id-M(:,:,1,7);
M(:,:,1,8)=U*(id+v8(1)*X+v8(2)*Y+v8(3)*Z)/2*U'; M(:,:,2,8)=id-M(:,:,1,8);
M(:,:,1,9)=U*(id+v9(1)*X+v9(2)*Y+v9(3)*Z)/2*U'; M(:,:,2,9)=id-M(:,:,1,9);
M(:,:,1,10)=U*(id+v10(1)*X+v10(2)*Y+v10(3)*Z)/2*U'; M(:,:,2,10)=id-M(:,:,1,10);
M(:,:,1,11)=U*(id+v11(1)*X+v11(2)*Y+v11(3)*Z)/2*U'; M(:,:,2,11)=id-M(:,:,1,11);
M(:,:,1,12)=U*(id+v12(1)*X+v12(2)*Y+v12(3)*Z)/2*U'; M(:,:,2,12)=id-M(:,:,1,12);
M(:,:,1,13)=U*(id+v13(1)*X+v13(2)*Y+v13(3)*Z)/2*U'; M(:,:,2,13)=id-M(:,:,1,13);
M(:,:,1,14)=U*(id+v14(1)*X+v14(2)*Y+v14(3)*Z)/2*U'; M(:,:,2,14)=id-M(:,:,1,14);
M(:,:,1,15)=U*(id+v15(1)*X+v15(2)*Y+v15(3)*Z)/2*U'; M(:,:,2,15)=id-M(:,:,1,15);
M(:,:,1,16)=U*(id+v16(1)*X+v16(2)*Y+v16(3)*Z)/2*U'; M(:,:,2,16)=id-M(:,:,1,16);
M(:,:,1,17)=U*(id+v17(1)*X+v17(2)*Y+v17(3)*Z)/2*U'; M(:,:,2,17)=id-M(:,:,1,17);
M(:,:,1,18)=U*(id+v18(1)*X+v18(2)*Y+v18(3)*Z)/2*U'; M(:,:,2,18)=id-M(:,:,1,18);
M(:,:,1,19)=U*(id+v19(1)*X+v19(2)*Y+v19(3)*Z)/2*U'; M(:,:,2,19)=id-M(:,:,1,19);
M(:,:,1,20)=U*(id+v20(1)*X+v20(2)*Y+v20(3)*Z)/2*U'; M(:,:,2,20)=id-M(:,:,1,20);
M(:,:,1,21)=U*(id+v21(1)*X+v21(2)*Y+v21(3)*Z)/2*U'; M(:,:,2,21)=id-M(:,:,1,21);
M(:,:,1,22)=U*(id+v22(1)*X+v22(2)*Y+v22(3)*Z)/2*U'; M(:,:,2,22)=id-M(:,:,1,22);
M(:,:,1,23)=U*(id+v23(1)*X+v23(2)*Y+v23(3)*Z)/2*U'; M(:,:,2,23)=id-M(:,:,1,23);
M(:,:,1,24)=U*(id+v24(1)*X+v24(2)*Y+v24(3)*Z)/2*U'; M(:,:,2,24)=id-M(:,:,1,24);
end
